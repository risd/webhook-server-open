#!/usr/bin/env node

/*

site=start-here,1risd,1systems
token=e443836a-ca8d-4c05-b4b4-18f7acd27ac2
id=-MulO5K8lqzdF6PqEIdU
data={"name":"QA Gallery - Are there student clubs at RISD?","_sort_create_date":1643653620,"create_date":"2022-01-31T13:27:00-05:00","_sort_last_updated":1643673660,"last_updated":"2022-01-31T19:01:00-05:00","_sort_publish_date":1643653620,"publish_date":"2022-01-31T13:27:00-05:00","gallery":"[{"image":{"resize_url":"https://lh3.googleusercontent.com/kf3AFZCoNo3CcH4kDgHqnyYVvW_7oAxjAxswJCEKOU2mnfxGS7d4Z4mAxOq2ZBXBtNGeKYjyfWKFIEzwlewZgl3QQbJ5JjkzQqihzF-GAzF1-vAkqTvU2KJP","url":"//cdn.risd.systems/webhook-uploads/1643653249596_?size=l"},"link_text":"@risdcycling","link_url":"https://www.instagram.com/p/BgtYaxZBFdv/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/ZS94j0eWauTFNc4xAzR41lfixTFdcArVFjDmhUNwZuDAFfo0yzXsDB__OEqr9hplvDbtHpqM1BWLgRL3h9rOKMPLTHmVtJgINGhHYHXALSQry5FS8MXF6VqL0g","url":"//cdn.risd.systems/webhook-uploads/1643653272026_?size=l"},"link_text":"@risd_beekeeping","link_url":"https://www.instagram.com/p/BzvV1nflErd/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/43jPKfSeBJaC-N3ZYXpbm3ffVjoSXy01EmZYFWUdsZGaFTr4v99NDURPuqsLX5lPgTVoS8FLxucLjE6RCkPVlX82z0Ss7USIBEnBnCh7NyEuFvxSrENdeLdV","url":"//cdn.risd.systems/webhook-uploads/1643653298201_?size=l"},"link_text":"@risdfoodlab","link_url":"https://www.instagram.com/p/BqWS_rPFPvu/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/4tPNXsLRhVnP3m2TuWVrpJmLrjl2OH0qAeG2IWQp0Z1ZUQ7iXwjecoKsUS70TQLeE8C6hab6r4xxGr0SBWhcJMzlyPLCD4420ri0TebJwQcbMEwDlp_IVdzZ","url":"//cdn.risd.systems/webhook-uploads/1643653319976_?size=l"},"link_text":"@gendotaiko","link_url":"https://www.instagram.com/p/BcJkAVSAxjS/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/gdXWFUfIvTaBP_LbXx7-hLviEBSx0tTM_Mtmm6a-U_jk_xgK7zpOhI1mMBkOazQk39TEI6gV7USutu44WD71ddCwONI0NL4P0gGL4sxB9VEjkVpbPgN_KQNn6A","url":"//cdn.risd.systems/webhook-uploads/1643653343302_?size=l"},"link_text":"@risdsa","link_url":"https://www.instagram.com/p/BnjcWk8FpZm/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/espcJfEhlsD2GafPYd6BbEVp4XM0Nptm21AO2sfzWMtnzjJwAOKijDiCi-DvP6crJDmWedVfl-_n9QSTx-7PLYWPU1cmBTq7009LOYBqJV9bGrabsts0d7g","url":"//cdn.risd.systems/webhook-uploads/1643653363693_?size=l"},"link_text":"@risd1877","link_url":"https://www.instagram.com/p/B1zX-jqA6ZN/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/sQt946wxgKE3F_3Yi58jco1w72jQWg5uv_u7RjaL1cryqsGTuMPNRX2bMnWglaMG07x0KpSLgmJ3bgdko9M_7OJuylTFSbKRGsVUA2DSRfZeTp5kbhfQguwd","url":"//cdn.risd.systems/webhook-uploads/1643653384131_?size=l"},"link_text":"@brownrisdgamedev","link_url":"https://www.instagram.com/p/Bnj3vf3gXs1/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/V5wCd1EcsXr9qdjBBbJLo8IwHhPz1XxMD7ys0kF5y8ohTM_2R79l5e6XSw_Zj8ib5qMlW21oEJRBmvF6cNRB4H3YJjYYshT3nz4qqXGQ9EMmQmPWgbc57Uk1","url":"//cdn.risd.systems/webhook-uploads/1643653413383_?size=l"},"link_text":"@risd1877","link_url":"https://www.instagram.com/p/BTHl-ALgfDK/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/E_P1VmcyCqjTLU1WzKyWoD_uSsZ_ngcaIdTd6bUzvhN_JLu0PQ-PJeRWLSOczNz1LGT8rA5viJqGuPWuEyL-BNWKxgTMNFCXlNwmiyhRfhEu-ExM7tB2gP6A","url":"//cdn.risd.systems/webhook-uploads/1643653432490_?size=l"},"link_text":"@risdbaad","link_url":"https://www.instagram.com/p/B9AaexmFIBO/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/dilNuepHsgs5dqgDn7w-4Efe-fq1B5jIUfETWfkwccp-3bMQ6gqvHbASXJ7ebgaLI4lIjc1JFJTMcCnBJ8IDojAopk5cyHY_6Jc0WAuYC3Az703DAEHtNBjm","url":"//cdn.risd.systems/webhook-uploads/1643653456724_?size=l"},"link_text":"@risd1877","link_url":"https://www.instagram.com/p/BbfQ8V8ALGT/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/mOqPxU1Foj4VFkKr5c90MCXbAwO35KIU477AnjXzGGJ0eDbqKxxmo5qehaczWsnAniBaDrgXnme7VVrsE2rhQMmgVpHfHXp7AMXNYuXnncuKq3oLtkYoj8ai","url":"//cdn.risd.systems/webhook-uploads/1643653476469_?size=l"},"link_text":"@risdsasa","link_url":"https://www.instagram.com/p/Bie1bFGl2AL/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/eaO0AixquRSLGiwM2BMAfA64d5pJb5kQ9P2TQn2i8AwBzbDVH_1xXqS_ebBOwHWtKbc0apVzS6XadsV8-Dt24q1P9NCG2P3Pis6esADyhhTe574ZVDtxqOLq","url":"//cdn.risd.systems/webhook-uploads/1643653501782_?size=l"},"link_text":"@risd_idsa","link_url":"https://www.instagram.com/p/BpZwVI9Fdgh/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/lXH2ACUKL40kmtFKDuo-WQmp2aNvR0QIEmlyIeXVCSmJki9-_IXcOpbqZPDQahaVAaP9HdK1Xmmbg-5bfxtFdMKETQp8gfc8TRCOzgZU5tEFNBlnPqnWXaMscw","url":"//cdn.risd.systems/webhook-uploads/1643653522154_?size=l"},"link_text":"@risdquickies","link_url":"https://www.instagram.com/p/BKtXYiPB-p2/"},{"image":{"resize_url":"https://lh3.googleusercontent.com/Jrw0kguyUK6K8ZUQ5fg4Z6WDsWcpebeH8ITWKU18Ade5JFj735tPTLy77JhAAq5K2cRTqkzmYt9JTkCSbWCMgYoJ4I3r1kxBo7dY0ek5Ms6f5pif_P91Yu2T","url":"//cdn.risd.systems/webhook-uploads/1643653554890_?size=l"},"link_text":"@risdmangostreet","link_url":"https://www.instagram.com/p/CFM2oNtjTOc/"}]","preview_url":"48e7720f-612f-cf11-3a24-ab3e90d0b543","isDraft":false}
typeName=galleries
oneOff=false

*/
const argv = require('minimist')(process.argv.slice(2), {
  alias: {
    n: 'siteName',
    d: 'doc',
    c: 'contentType',
    i: 'id',
    o: 'oneOff',
  },
})
const grunt = require( 'grunt' )
const webhookTasks = require( '../Gruntfile.js' )
const Elastic = require( 'webhook-elastic-search' )

webhookTasks(grunt)

const elastic = Elastic(grunt.config.get('elastic'))

;(async () => {
  await elastic.indexDocument({
    siteName: argv.siteName,
    contentType: argv.contentType,
    doc: argv.doc,
    id: argv.id,
    oneOff: argv.oneOff,
  })
})()
